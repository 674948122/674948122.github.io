import{_ as n,Z as e,$ as a,a1 as s}from"./framework-4b017f08.js";const i={},d=s(`<h1 id="spa单页面部署后刷新404" tabindex="-1"><a class="header-anchor" href="#spa单页面部署后刷新404" aria-hidden="true">#</a> SPA单页面部署后刷新404</h1><h2 id="项目场景" tabindex="-1"><a class="header-anchor" href="#项目场景" aria-hidden="true">#</a> 项目场景</h2><ul><li><p>将vue项目打包部署到<code>nginx</code>上面运行</p></li><li><p>打开<code>nginx</code>的主配置文件： <code>nginx</code>安装目录<code>/conf/nginx.conf</code>。</p></li><li><p>将<code>vueCLI</code>打的项目包（<code>dist</code>目录）交给<code>nginx</code>服务来管理。使得访问某些路径时，可以指向<code>dist/index.html</code>。</p></li></ul><h2 id="问题描述" tabindex="-1"><a class="header-anchor" href="#问题描述" aria-hidden="true">#</a> 问题描述</h2><ul><li><p>运行时页面白屏。</p></li><li><p>页面可以正常显示，当刷新页面的时候页面报404错误。</p></li></ul><h2 id="原因分析" tabindex="-1"><a class="header-anchor" href="#原因分析" aria-hidden="true">#</a> 原因分析</h2><p>页面白屏分析：我们可以先查看一下nginx下的 <code>logs/error.log</code> 日志文件，确定我的问题是因为项目打包时候路劲配置问题。</p><p>页面404分析：我们在将 <code>vue</code>项目打包部署时，地址栏的地址只是 <code>vue</code>的路由，并不是真正的文件目录地址。所有的路由都是依赖于 <code>SPA单页应用</code>的<code>index.html</code>，所以当我们在刷新时，按照地址栏的地址，找不到对应的文件，就产生404。</p><h2 id="解决方案" tabindex="-1"><a class="header-anchor" href="#解决方案" aria-hidden="true">#</a> 解决方案</h2><p>配置nginx中conf目录下的nginx.conf文件</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code>location <span class="token operator">/</span> <span class="token punctuation">{</span>
    # root定义网站根目录   html
    root   dist<span class="token punctuation">;</span>

    # index定义网站的首页   html<span class="token operator">/</span>index<span class="token punctuation">.</span>html
    index  index<span class="token punctuation">.</span>html index<span class="token punctuation">.</span>htm<span class="token punctuation">;</span>

    # 避免f5刷新后<span class="token number">404</span>
    try_files  $uri  $uri<span class="token operator">/</span>  <span class="token operator">/</span>index<span class="token punctuation">.</span>html<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>重启ngnix</p><p><code>nginx -s reload</code></p>`,13),c=[d];function o(t,l){return e(),a("div",null,c)}const p=n(i,[["render",o],["__file","SPA单页面部署后刷新404.html.vue"]]);export{p as default};
