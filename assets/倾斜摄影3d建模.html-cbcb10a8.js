import{_ as i,X as o,Y as c,$ as s,a0 as n,a1 as a,Z as t,E as p}from"./framework-cddc4983.js";const l="/assets/images/170ecd4502aa3545.png",r="/assets/images/170ecd4a2f312bef.png",d="/assets/images/170ecd8160c793bb.png",u="/assets/images/170ecd9ab3b3b34f.png",m="/assets/images/170ecdaac5450d7b.png",v="/assets/images/170ecdc1290489e5.png",g="/assets/images/170ecdd441abbd32.png",k="/assets/images/170ecdf2400f43d3.png",h="/assets/images/170ecff5259e69f7.png",b={},f=t('<h1 id="倾斜摄影3d建模" tabindex="-1"><a class="header-anchor" href="#倾斜摄影3d建模" aria-hidden="true">#</a> 倾斜摄影3d建模</h1><h2 id="技术选型" tabindex="-1"><a class="header-anchor" href="#技术选型" aria-hidden="true">#</a> 技术选型</h2><p><code>vue-cesium</code>、<code>coordtransform</code></p><h2 id="相关文档地址" tabindex="-1"><a class="header-anchor" href="#相关文档地址" aria-hidden="true">#</a> 相关文档地址</h2>',4),_={href:"https://zouyaoji.top/vue-cesium-v2/#/zh/start/usage",title:"vue-cesium",target:"_blank",rel:"noopener noreferrer"},y={href:"https://www.npmjs.com/package/coordtransform",title:"coordtransform",target:"_blank",rel:"noopener noreferrer"},j={href:"http://www.cesiumlab.com/",title:"cesium实验室",target:"_blank",rel:"noopener noreferrer"},x={href:"http://cesiumcn.org/guide/",title:"cesium.js中文文档",target:"_blank",rel:"noopener noreferrer"},C={href:"https://cesium.com/platform/cesiumjs/",title:"cesium官网",target:"_blank",rel:"noopener noreferrer"},w=t('<p>tips：以上文档有些在外网，无法访问请自行翻墙。</p><h2 id="实现过程" tabindex="-1"><a class="header-anchor" href="#实现过程" aria-hidden="true">#</a> 实现过程</h2><h3 id="_1、使用无人机对建筑物进行倾斜拍摄-产出osgb文件" tabindex="-1"><a class="header-anchor" href="#_1、使用无人机对建筑物进行倾斜拍摄-产出osgb文件" aria-hidden="true">#</a> 1、使用无人机对建筑物进行倾斜拍摄，产出<code>osgb</code>文件</h3><p><img src="'+l+'" alt="图片" loading="lazy"><img src="'+r+'" alt="图片" loading="lazy"></p><h3 id="_2、使用cesium实验室软件-将osgb文件转换成3dtiles文件-软件请在上方的相关文档中的cesium实验室网站中下载" tabindex="-1"><a class="header-anchor" href="#_2、使用cesium实验室软件-将osgb文件转换成3dtiles文件-软件请在上方的相关文档中的cesium实验室网站中下载" aria-hidden="true">#</a> 2、使用<code>cesium实验室</code>软件，将<code>osgb</code>文件转换成<code>3dtiles</code>文件，软件请在上方的相关文档中的cesium实验室网站中下载</h3><p>tips：<code>cesium实验室</code>只有windows版本，mac环境可以安装虚拟机来进行这一步的转换工作。</p><figure><img src="'+d+'" alt="图片" tabindex="0" loading="lazy"><figcaption>图片</figcaption></figure><p>打开软件后，会自动打开浏览器<code>http://localhost:9003/login.html</code></p><figure><img src="'+u+'" alt="图片" tabindex="0" loading="lazy"><figcaption>图片</figcaption></figure><p>按照一般网站的流程，注册账号，并登陆，点击<code>倾斜模型转换</code>按钮</p><figure><img src="'+m+'" alt="图片" tabindex="0" loading="lazy"><figcaption>图片</figcaption></figure><p>输入文件路径要选择osbg中的Data目录。</p><figure><img src="'+v+'" alt="图片" tabindex="0" loading="lazy"><figcaption>图片</figcaption></figure><p>储存类型选择<code>散列</code>，这很重要！然后选择文件输出的路径，这个根据自己需求来定。</p><figure><img src="'+g+'" alt="图片" tabindex="0" loading="lazy"><figcaption>图片</figcaption></figure><p>根据文件大小不同，20G左右要转换40分钟左右，耐心等待。</p><figure><img src="'+k+`" alt="图片" tabindex="0" loading="lazy"><figcaption>图片</figcaption></figure><h3 id="_3、引入vue-cesium" tabindex="-1"><a class="header-anchor" href="#_3、引入vue-cesium" aria-hidden="true">#</a> 3、引入vue-cesium</h3><p>安装插件</p><p>运行命令<code>npm i vue-cesium@2</code>或者<code>yarn add vue-cesium@2</code>. tips: 注意要规定版本，因为该插件最新版本支持vue3。 2和3版本不兼容</p><p>引入插件</p><p>在<code>main.js</code>入口文件中，写入以下代码。</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token comment">// 集成cesium数字地球</span>
<span class="token keyword">import</span> VueCesium <span class="token keyword">from</span> <span class="token string">&#39;vue-cesium&#39;</span>
<span class="token keyword">import</span> <span class="token string">&#39;vue-cesium/lib/style.css&#39;</span>
Vue<span class="token punctuation">.</span><span class="token function">use</span><span class="token punctuation">(</span>VueCesium<span class="token punctuation">,</span> <span class="token punctuation">{</span>
  <span class="token comment">// cesiumPath 是指引用的Cesium.js路径，如</span>
  <span class="token comment">// 项目本地的Cesium Build包，vue项目需要将Cesium Build包放static目录：</span>
  <span class="token literal-property property">cesiumPath</span><span class="token operator">:</span> <span class="token string">&#39;/static/Cesium/Cesium.js&#39;</span><span class="token punctuation">,</span>
  <span class="token comment">// 个人在线Cesium Build包：</span>
  <span class="token comment">// cesiumPath: &#39;https://zouyaoji.top/vue-cesium/statics/Cesium/Cesium.js&#39;</span>
  <span class="token comment">// 个人在线SuperMap Cesium Build包（在官方基础上二次开发出来的）：</span>
  <span class="token comment">// cesiumPath: &#39;https://zouyaoji.top/vue-cesium/statics/SuperMapCesium/Cesium.js&#39;</span>
  <span class="token comment">// 官方在线Cesium Build包，有CDN加速，推荐用这个：</span>
  <span class="token comment">// cesiumPath: &#39;https://unpkg.com/cesium@latest/Build/Cesium/Cesium.js&#39;,</span>
  <span class="token comment">// 指定Cesium.Ion.defaultAccessToken，使用Cesium ion的数据源需要到https://cesium.com/ion/申请一个账户，获取Access Token。不指定的话可能导致 Cesium 在线影像加载不了</span>
  <span class="token literal-property property">accessToken</span><span class="token operator">:</span> <span class="token string">&#39;eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJqdGkiOiI0MDk3MmVkYy1lZjM3LTQ3YTgtOGRmOS0yYmE5MWVkYjg3NzYiLCJpZCI6MTA0NDIwLCJpYXQiOjE2NjAyMDMxNjR9.zjOBcyV9oNPHQ43Ra-xjmwDdFiqarWvxgj_wAAR3TLM&#39;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,23),z=s("code",null,"accessToken",-1),G={href:"https://cesium.com/platform/cesiumjs/",title:"cesium官网",target:"_blank",rel:"noopener noreferrer"},S=s("p",null,"使用组件",-1),I={href:"https://zouyaoji.top/vue-cesium-v2/#/zh/imageryLayer/vc-provider-imagery-baidumap",title:"vue-cesium文档",target:"_blank",rel:"noopener noreferrer"},B=s("h3",{id:"_4、将3dtiles集成进cesium地球",tabindex:"-1"},[s("a",{class:"header-anchor",href:"#_4、将3dtiles集成进cesium地球","aria-hidden":"true"},"#"),n(" 4、将3dtiles集成进cesium地球")],-1),D=s("p",null,[n("将在上面准备好的"),s("code",null,"3dtiles"),n("文件，放在一个可以被外部访问的服务中，比如"),s("code",null,"nginx"),n("，")],-1),N=s("code",null,"vc-viewer",-1),V={href:"https://zouyaoji.top/vue-cesium-v2/#/zh/primitive/vc-primitive-tileset",title:"集成3dtiles模型文档",target:"_blank",rel:"noopener noreferrer"},J=t(`<div class="language-vue line-numbers-mode" data-ext="vue"><pre class="language-vue"><code><span class="token comment">&lt;!-- 3d建模 --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>vc-primitive-tileset</span>
    <span class="token attr-name">:url</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>url<span class="token punctuation">&quot;</span></span>
    <span class="token attr-name">preferLeaves</span>
    <span class="token attr-name">preloadFlightDestinations</span>
    <span class="token attr-name">dynamicScreenSpaceError</span> 
<span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>vc-primitive-tileset</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><code>url: &#39;http://192.168.31.173:5500/tileset.json&#39;, // 3d建模地址</code></p><p>tips；上面的<code>url</code>参数，就是<code>3dtiles</code>中的<code>tileset.json</code>文件，这个文件就相当于是一个3dtiles模型的目录配置，将里面的建模资源组织起来。</p><p>至此你已经可以在页面上看到效果了，接下来可以根据经纬度，定位到准确的地址，欣赏你的作品了。</p><h2 id="一些问题和难点" tabindex="-1"><a class="header-anchor" href="#一些问题和难点" aria-hidden="true">#</a> 一些问题和难点</h2><h3 id="坐标偏移" tabindex="-1"><a class="header-anchor" href="#坐标偏移" aria-hidden="true">#</a> 坐标偏移</h3><p>互联网坐标系的现状</p><ol><li>地球坐标 (WGS84)</li></ol><p>国际标准，从GPS设备中取出的数据的坐标系 国际地图提供商使用的坐标系 2. 火星坐标 (GCJ-02) 也叫国测局坐标系</p><p>中国标准，从国行移动设备中定位获取的坐标数据使用这个坐标系</p><p><code>国家规定： 国内出版的各种地图系统（包括电子形式），必须至少采用GCJ-02对地理位置进行首次加密。</code> 3. 百度坐标 (BD-09)</p><p>百度标准，百度 SDK，百度地图，Geocoding 使用 百度在火星坐标上来了个二次加密</p><p>设备与坐标系的关系</p><ol><li>从设备获取经纬度（GPS）坐标</li></ol><p>百度SDK，可以获取百度坐标（bd09，默认）或者火星坐标（GCJ02） IOS原生定位库，可以获取WGS84坐标 高德SDK，可以获取GCJ02坐标 2. 互联网在线地图使用的坐标系</p><ul><li>火星坐标系：</li></ul><p>ios地图（其实是高德） Google国内地图（.cn域名下） 搜搜、阿里云、高德地图、腾讯</p><ul><li>百度坐标系：</li></ul><p>百度地图</p><ul><li>WGS84坐标系：</li></ul><p>Google国外地图 osm地图等国外地图</p><p>这里推荐一款插件<code>coordtransform</code>，来进行坐标转换。<code>cesium</code>使用的是<code>wgs84</code>坐标系。</p><p>请根据你的情况来转换坐标。</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token keyword">import</span> coordtransform <span class="token keyword">from</span> <span class="token string">&quot;coordtransform&quot;</span><span class="token punctuation">;</span>

<span class="token comment">// 坐标转换</span>
<span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">positionTransform</span><span class="token punctuation">(</span><span class="token parameter">_lng<span class="token punctuation">,</span> _lat</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// 百度坐标转火星坐标</span>
  <span class="token keyword">const</span> bd09togcj02 <span class="token operator">=</span> coordtransform<span class="token punctuation">.</span><span class="token function">bd09togcj02</span><span class="token punctuation">(</span>_lng<span class="token punctuation">,</span> _lat<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// 火星坐标转标准坐标</span>
  <span class="token keyword">const</span> gcj02towgs84 <span class="token operator">=</span> coordtransform<span class="token punctuation">.</span><span class="token function">gcj02towgs84</span><span class="token punctuation">(</span>
    bd09togcj02<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    bd09togcj02<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">lng</span><span class="token operator">:</span> gcj02towgs84<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token comment">// 经度 X 120</span>
    <span class="token literal-property property">lat</span><span class="token operator">:</span> gcj02towgs84<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token comment">// 纬度 Y  36</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="坐标打点" tabindex="-1"><a class="header-anchor" href="#坐标打点" aria-hidden="true">#</a> 坐标打点</h3><p>这个功能实现起来有很多中方法，这里推荐使用插入html元素的方式，因为这样样式可以更灵活，不受canvas的限制。</p><p>在<code>vue-cesium</code>中选择<code>vc-overlay-html</code>组件</p><p>tips：如果你想动态的现实隐藏这些标记，请不要在<code>vc-overlay-html</code>标签上使用<code>v-if</code>指令，反复切换，会导致它不再渲染，显示隐藏可以在内容物<code>html</code>上下手</p><figure><img src="`+h+'" alt="图片" tabindex="0" loading="lazy"><figcaption>图片</figcaption></figure>',29);function M(T,L){const e=p("ExternalLinkIcon");return o(),c("div",null,[f,s("p",null,[s("a",_,[n("vue-cesium"),a(e)])]),s("p",null,[s("a",y,[n("coordtransform"),a(e)])]),s("p",null,[s("a",j,[n("cesium实验室"),a(e)])]),s("p",null,[s("a",x,[n("cesium.js中文文档"),a(e)])]),s("p",null,[s("a",C,[n("cesium官网"),a(e)])]),w,s("p",null,[n("tops："),z,n("参数请到cesium官方网站中自行注册获取。"),s("a",G,[n("cesium官网"),a(e)])]),S,s("p",null,[n("代码过长，不在这里演示了，请查看"),s("a",I,[n("vue-cesium文档"),a(e)]),n("，写的非常详细。")]),B,D,s("p",null,[n("在"),N,n("标签中写入一下代码，"),s("a",V,[n("集成3dtiles模型文档"),a(e)])]),J])}const Y=i(b,[["render",M],["__file","倾斜摄影3d建模.html.vue"]]);export{Y as default};
